#!/usr/bin/env bash
# Install common CLI tools via Cargo
set -euo pipefail

echo "==> Installing cargo-installed CLI tools..."

# Load cargo env to ensure PATH/vars are set (handles non-interactive shells)
if [ -f "$HOME/.cargo/env" ]; then
    # shellcheck disable=SC1091
    source "$HOME/.cargo/env"
fi

# Ensure cargo is available (rustup must have been installed by run_once_10)
if ! command -v cargo >/dev/null 2>&1; then
    echo "Error: cargo not found. Install Rust first (run_once_10-install-rust.sh)." >&2
    exit 1
fi

# Install tools (idempotent; cargo skips if already installed)
cargo install --locked \
    bat \
    exa \
    fd-find \
    ripgrep \
    starship

echo "âœ“ Cargo tools installed"