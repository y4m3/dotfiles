// =============================================================================
// Zellij Default Layout with zjstatus
// Path: ~/.config/zellij/layouts/default.kdl
//
// Uses zjstatus plugin for a customized status bar with Tokyo Night theme.
// =============================================================================

layout {
    default_tab_template {
        // ---------------------------------------------------------------------
        // zjstatus: Custom status bar (top)
        // Tokyo Night color palette
        // ---------------------------------------------------------------------
        pane size=1 borderless=true {
            plugin location="file:{{ .chezmoi.homeDir }}/.config/zellij/plugins/zjstatus.wasm" {
                // Format layout (tabs right-aligned like tmux)
                format_left   "{mode}#[fg=#565f89] {session} #[fg=#414868]│#[fg=default]{command_git_branch}"
                format_center ""
                format_right  "{tabs}#[fg=#414868]│ #[fg=#565f89]{datetime}"
                format_space  ""

                // Hide frame for minimal UI
                hide_frame_for_single_pane false

                // Mode indicators (Tokyo Night colors)
                mode_normal        "#[fg=#565f89] NORMAL "
                mode_tmux          "#[fg=#7aa2f7,bold] TMUX "
                mode_locked        "#[fg=#f7768e,bold] LOCKED "
                mode_resize        "#[fg=#9ece6a,bold] RESIZE "
                mode_pane          "#[fg=#bb9af7,bold] PANE "
                mode_tab           "#[fg=#e0af68,bold] TAB "
                mode_scroll        "#[fg=#7dcfff,bold] SCROLL "
                mode_search        "#[fg=#ff9e64,bold] SEARCH "
                mode_move          "#[fg=#bb9af7,bold] MOVE "
                mode_session       "#[fg=#7aa2f7,bold] SESSION "
                mode_enter_search  "#[fg=#ff9e64,bold] SEARCH "
                mode_rename_tab    "#[fg=#e0af68,bold] RENAME "
                mode_rename_pane   "#[fg=#bb9af7,bold] RENAME "

                // Tab formatting
                tab_normal              "#[fg=#565f89]▕ {index} "
                tab_normal_fullscreen   "#[fg=#565f89]▕ {index} "
                tab_normal_sync         "#[fg=#565f89]▕ {index} "
                tab_active              "#[fg=#7aa2f7]▕ {index} "
                tab_active_fullscreen   "#[fg=#7aa2f7]▕ {index} #[fg=#ff9e64]◈ "
                tab_active_sync         "#[fg=#7aa2f7]▕ {index} #[fg=#9ece6a]● "

                // Git branch display (5 second refresh)
                command_git_branch_command     "git rev-parse --abbrev-ref HEAD 2>/dev/null || echo ''"
                command_git_branch_format      "#[fg=#565f89] {stdout} "
                command_git_branch_interval    "5"
                command_git_branch_rendermode  "static"

                // Date/time display
                datetime          "#[fg=#565f89]{format}"
                datetime_format   "%H:%M "
            }
        }
        children
    }

    tab
}
