# =============================================================================
# tmux Submodes (Custom Key Tables)
# Emulates Zellij's submode system using tmux key tables
# =============================================================================

# =============================================================================
# Resize Mode (matches Zellij Resize Mode)
# Enter with: prefix r
# Exit with: Esc, Enter, or q
# =============================================================================
bind r switch-client -T resize-mode

# Resize in direction (repeatable)
bind -T resize-mode h resize-pane -L 5 \; switch-client -T resize-mode
bind -T resize-mode j resize-pane -D 5 \; switch-client -T resize-mode
bind -T resize-mode k resize-pane -U 5 \; switch-client -T resize-mode
bind -T resize-mode l resize-pane -R 5 \; switch-client -T resize-mode

# Resize in reverse direction (repeatable)
bind -T resize-mode H resize-pane -R 5 \; switch-client -T resize-mode
bind -T resize-mode J resize-pane -U 5 \; switch-client -T resize-mode
bind -T resize-mode K resize-pane -D 5 \; switch-client -T resize-mode
bind -T resize-mode L resize-pane -L 5 \; switch-client -T resize-mode

# Exit resize mode
bind -T resize-mode Escape switch-client -T root
bind -T resize-mode Enter switch-client -T root
bind -T resize-mode q switch-client -T root

# =============================================================================
# Tab Mode (matches Zellij Tab Mode)
# Enter with: prefix t
# Exit with: Esc, Enter, or q
# =============================================================================
bind t switch-client -T tab-mode

# Rename window (matches Zellij Tab Mode r)
bind -T tab-mode r command-prompt -I "#W" "rename-window -- '%%'"

# Navigate windows (matches Zellij Tab Mode h/l)
bind -T tab-mode h previous-window \; switch-client -T tab-mode
bind -T tab-mode l next-window \; switch-client -T tab-mode

# New window (matches Zellij Tab Mode n)
bind -T tab-mode n new-window -c "#{pane_current_path}"

# Close window (matches Zellij Tab Mode x)
bind -T tab-mode x kill-window

# Synchronize panes (matches Zellij Tab Mode s)
bind -T tab-mode s setw synchronize-panes \; switch-client -T tab-mode

# Break pane (matches Zellij Tab Mode b)
bind -T tab-mode b break-pane

# Toggle to last window (matches Zellij Tab Mode Tab)
bind -T tab-mode Tab last-window

# Window selection by number
bind -T tab-mode 1 select-window -t :1
bind -T tab-mode 2 select-window -t :2
bind -T tab-mode 3 select-window -t :3
bind -T tab-mode 4 select-window -t :4
bind -T tab-mode 5 select-window -t :5
bind -T tab-mode 6 select-window -t :6
bind -T tab-mode 7 select-window -t :7
bind -T tab-mode 8 select-window -t :8
bind -T tab-mode 9 select-window -t :9

# Exit tab mode
bind -T tab-mode Escape switch-client -T root
bind -T tab-mode Enter switch-client -T root
bind -T tab-mode q switch-client -T root

# =============================================================================
# Pane Mode (matches Zellij Pane Mode)
# Enter with: prefix p
# Exit with: Esc, Enter, or q
# =============================================================================
bind p switch-client -T pane-mode

# Navigate panes (repeatable, matches Zellij Pane Mode h/j/k/l)
bind -T pane-mode h select-pane -L \; switch-client -T pane-mode
bind -T pane-mode j select-pane -D \; switch-client -T pane-mode
bind -T pane-mode k select-pane -U \; switch-client -T pane-mode
bind -T pane-mode l select-pane -R \; switch-client -T pane-mode

# Toggle to last pane (matches Zellij Pane Mode p)
bind -T pane-mode p last-pane \; switch-client -T pane-mode

# New pane (matches Zellij Pane Mode n)
bind -T pane-mode n split-window -c "#{pane_current_path}"

# Close pane (matches Zellij Pane Mode x)
bind -T pane-mode x kill-pane

# Zoom toggle (matches Zellij Pane Mode f)
bind -T pane-mode f resize-pane -Z

# Exit pane mode
bind -T pane-mode Escape switch-client -T root
bind -T pane-mode Enter switch-client -T root
bind -T pane-mode q switch-client -T root

# =============================================================================
# Move Mode (matches Zellij Move Mode)
# Enter with: prefix m
# Exit with: Esc, Enter, or q
# =============================================================================
bind m switch-client -T move-mode

# Move pane in direction (matches Zellij Move Mode h/j/k/l)
bind -T move-mode h swap-pane -s '{left-of}' \; switch-client -T move-mode
bind -T move-mode j swap-pane -s '{down-of}' \; switch-client -T move-mode
bind -T move-mode k swap-pane -s '{up-of}' \; switch-client -T move-mode
bind -T move-mode l swap-pane -s '{right-of}' \; switch-client -T move-mode

# Rotate panes (matches Zellij Move Mode n/Tab and p)
bind -T move-mode n swap-pane -D \; switch-client -T move-mode
bind -T move-mode Tab swap-pane -D \; switch-client -T move-mode
bind -T move-mode p swap-pane -U \; switch-client -T move-mode

# Exit move mode
bind -T move-mode Escape switch-client -T root
bind -T move-mode Enter switch-client -T root
bind -T move-mode q switch-client -T root
