#!/bin/bash
# run_once_10-install-rust.sh.tmpl
# Install Rust (rustup + cargo) for host environment

set -e

echo "==> Checking Rust installation..."

# Skip if rustup is already installed
if command -v rustup &>/dev/null; then
    echo "✓ Rust already installed ($(rustup --version))"
else
    echo "==> Installing Rust via rustup..."

    # Install Rust using official installer
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --no-modify-path

    # Load cargo environment for current session
    if [ -f "$HOME/.cargo/env" ]; then
        source "$HOME/.cargo/env"
    fi

    echo "✓ Rust installed successfully"
    echo "  Version: $(rustc --version)"
    echo "  Cargo: $(cargo --version)"
    echo ""
    echo "  Note: Restart your shell or run 'source ~/.cargo/env' to use Rust"
fi
